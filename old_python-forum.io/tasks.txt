
            Парсинг Форума https://python-forum.io          
------------------------------------------------------------
* Нужно сделать переходы по категориям на сайте
* В каждой категории распарсить вопросы переходя по страницам
* Что нужно распарсить:
    - название вопроса (title);
    - кол-во ответов (answer);
    - кол-во просмотров (views);
    - дата создания вопроса (date);
    - сам вопрос, только текст (question).


Есть 4 таблицы. Первые три с категориями. В таблице есть теги tbody.
В tbody есть теги tr и td, отвечающие за строки и столбцы.
Нам нужны td с класом trow1/trow2 в них содеожатся названия категорий, ссылка и информация.

find_all tbody class re(trow0-9)


TODO
==============================
(?) Парсинг, сохранение и запись в файл вопросов (pickle)
Написать отдельную главную функцию с параметрами
Добавить исключения 
Создать таблицу с полями 
Сохранение в БД
Распарсить форум

(?) Отдельный файл работающий с БД
----------------------------------
load() - загрузка с файла переменной
dump() - сохранение в файл переменной
save_to_db() - сохранение в бд


Как работает парсер Stackoverflow
----------------------------------

Soapi парсит основные данные заголовки, время, промотры и т.д.
Parseq парсит сами вопросы при помощи bs4.
В soapi данные сохраняются соразу в БД, а в parseq можно как в БД так и отдельно в файл. Помимо этого в для parseq есть отдельный скрипт сохраняющий из файла в БД.

Необходимо сделать сохранение в бд, и отдельно в файл (потом в бд) в написанном модуле (SaveDB), для того чтобы потом можно было использовать для последующих скриптов парсинга.

Как будет работать парсер форума1
---------------------------------

Указываю категорию и идёт парсинг этой категории вопросов постранично.
После каждой страницы возвращает список (или словарь) с данными.
Нужно сохранять каждую страницу и сделать проверку, если есть вопрос в БД, то пропускать.
Сохранение сразу в БД т.к. всё равно качает быстро и без блокировки.
В программе сделать главную функцию принимающие парамметры все качать или определённую категорию с определённой страницей.

Проблемы которые встретятся (или уже встречались) в парсерах.
-------------------------------------------------------------
* Сохранение времени (в каком формате, часовой пояс)
* Кодировка текстов (вопросов и заголовков, с сохранением неизвестной кодировки)
* В некоторых сайтах блокировка

Необходимо учесть при написании цельного парсера.
Писать ли единую программа для парсинга или парсить по отдельным сайтам.
Можно сначала написать все скрипты под каждый сайт. Далее распарсить все вопросы, и заниматься сайтом и отображением. После этого, если будет свободное время скомпоновать все скрипты в одну программу.


БД для сохранения данных с форума
=================================
Нужно добавить поле для id
Поля БД:
  *id
  *title
  *href
  *question
  *answer
  *views
1 таблица основная, остальные под категории.
Названия как у категорий:
  *general_coding_help
  *homework
  *gui
  *game_development
  *networking
  *web_development
  *news_and_discussions
  *tutorials
  *completed_scripts/snippets
  *jobs
  *board
  *bar

Ошибка со парсингом Tutrials
------------------------------------------------
Traceback (most recent call last):
  File "forum1_3v.py", line 294, in <module>
    main_function(command)
  File "forum1_3v.py", line 273, in main_function
    for i in range(parse_count_pages(url)):
  File "forum1_3v.py", line 196, in parse_count_pages
    count = re.findall('\d+', str(div_pagination.span.text))
AttributeError: 'NoneType' object has no attribute 'span'

Такие ошибки в категориях:
Game Tutorials
Web Tutorials
GUI tutorials
Networking Tutorials 

===============================================
Варианты реализовать вывод книг и поиск по ним:
1) Написать/найти конвертер pdf в xml поиск и парсинг файлов xml далее вывод страниц
В зависимости от страницы вывод опред. главы, всю информацию по поиску вывести на сайт
Выбрать результат
Далее перенаправление на cтраницу в онлайн viewer-е pdf

Минус подхода:
Парсинг всех книг + файлы xml помимо pdf
Долгий поиск и вывод (возможно)
Разный парсинг под разные книги
2) Вывод pdf viewer-ом на странице.
Придумать как реализовать поискa



            PDF2TXT               
----------------------------------
[x] TODO --> Изменение метки на тег и номер страницы
[x] TODO --> Вручную убрать не нужные метки (или попробовать написать скрипт)
[x] TODO --> Изменить все книги в txt и выполнить действия над всеми
[x] TODO --> Поиск по тексту и вывод страницы

Вариант с написанием парсера
----------------------------
Плюсы
- Можно автоматизировать
Минусы найденой реализации/модуля
- Плохой парсинг текста (дробление слов)
- Отсутствие полной документации

Вариант с использованием Adobe и сохранением как текст
----------------------------
Плюсы
- Неплохой парсинг текста
Минусы
- Делается вручную
- Слова с новой строки
- Метка на новой страници без нумерации 
- Нужно исправить метку на номер страници и тег

----------Вывод pdf на сайте--------------
[x] TODO -> перейти с 2 на 3 версию Flask
[x] TODO -> создать страницу для поиска по книгам
[x] TODO -> вывод pdf
[x] TODO -> добавить к сайту чтобы в нём работало
[x] TODO -> отдельный модуль для поиска по книгам
[x] TODO -> вывод результатов на сайт, страницы
[x] TODO -> переход по страницам

до 02.04.18
Задачи до ПОНЕДЕЛЬНИКА
----------------------
[x] TODO -> Правильный вывод номеров страниц с найденным словом
[ ] TODO -> Поиск слов в странице и выделение. Вывести при помощи pdf.js или ViewerJS
Не получилось сделать выделение найденных символов. При помощи чистого pdf.js не было найдено ни одного примера.
Можно сделать при помощи ViewerJS, но нужно каким-то образом выводить въювер на созданую страницу сбоку и динамически работать с ним через клиентский js.
При подключении получаю ошибки связанные с node.js.


до 05-06.04.2018
Задачи до ЧЕТВЕРГА/ПЯТНИЦЫ
------------------
[x] TODO -> Удалить лишние наработки (переместил в test scripts)
[x] TODO -> Исправить переход на страницы, теперь если книга таже делает только openPage без getDocument
[x] TODO -> Ошибка в поиске в книге "программ. python 4-е издание.pdf" слово=numpy резултат='953(2) 976(2)' вместо '953(2) 954(2) 976'. Причина была связанна с проверкой последней страницы в списке
[x] TODO -> Поправить страницы поиска с оригинальной PDF

Причина - страница пустая и из-за этого скрипт пропускает а счёт идёт дальше, поэтому где показывает в 977 на самом деле 980 в книге и 981 на сайте

Как решить?
1) Удалить ненужные страницы
+Быстро найду пустые страницы
-Не совсем верное отображение страниц на сайте и в книге со смещением
2) Добавить теги с переходом
+Правельное отображение страниц на сайте
-Вручную поменять номер страниц начиная с пустой

Исправил файлы pdf, правильное отображение: 
- Программирование на Python, 4-е издание, I том.pdf
- python-i-analiz-dannyih.pdf
- PyQt_Sozdanie_okonnykh_prilozheny_na_Python_3.pdf
- Programmirovanie_na_Python_3_Podrobnoe_rukovod.pdf
- Praktikum_po_algoritmizatsii_i_programmirovaniy.pdf
- Lutc_M._-_Izuchaem_Python_(4-e_izdanie)-_2011.pdf

[ ] TODO -> Добавить книги и исправить их
Распознавание книг:
+ "A_Myuller_Vvedenie_v_mashinnoe_obuchenie" 
+ "Bill_Lyubanovich_-_Prostoy_Python_Bestsellery_O_Reilly_-_2016"
+ "Effective_Python_itmozg"
+ "Gopi Subramanian - Python Data Science Cookbook - 2015" англ.
+ "Intermediate_Python_M_Khalid__vk_com_tproger"
+ "Python Data Visualization Cookbook [Milovanović 2013-11-25]" англ.
+ "Violent_Python_A_Cookbook_for_Hackers_Forensic_Analysts_Penetration_TJ_O_Connor_proglib" англ.
+ "avtostopom-po-python"
+ "flask-russian-docs"
+ "mastering-python-rick-van-hattem" англ.

- "Hight Perfomance Python" распознало пару страниц
- "Python и машинное обучение" не распознало через Adobe Reader, через Adobe Acrobat распознало но без меток страниц
- "VanderPlas J. - Python Data Science Handbook - 2017" не хотело распознать
- "Разработка веб-приложений с использованием Flask на языке Python" плохое качество и не распознало
- "Силен Д., Мейсман А. - Основы Data Science и Big Data. Python и наука о данных - 2017" не хотело распознать

Замена тегов:
+ "A_Myuller_Vvedenie_v_mashinnoe_obuchenie(2).txt"
+ "Bill_Lyubanovich_-_Prostoy_Python_Bestsellery_O_Reilly_-_2016(2).txt"
- "Effective_Python_itmozg(2).txt" из 683 страниц распознало 226
+ "Gopi Subramanian - Python Data Science Cookbook - 2015(2).txt" не распознало 15 страницу и я добавил её. Было 9 пустых страниц
+ "Intermediate_Python_M_Khalid__vk_com_tproger(2).txt"
+ "Python Data Visualization Cookbook [Milovanović 2013-11-25](2).txt" был распознан лишний тег 6 пустых стр.
+ "Violent_Python_A_Cookbook_for_Hackers_Forensic_Analysts_Penetration_TJ_O_Connor_proglib(2).txt" в начале не был распознан текст т.к. в книге непонятен формат 
+ "avtostopom-po-python(2).txt"
+ "flask-russian-docs(2).txt" 1 пустая страница
+ "mastering-python-rick-van-hattem(2).txt" где-то 10 пустых страниц

до 12.04.2018 
Задачи до ЧЕТВЕРГА
------------------

[x] TODO -> Верстка. Поменял стиль scrollbar страницы и блока. Сделал фиксированным блок с PDF. Убрал мелкие недороботки
[x] TODO -> Верстка. Изменить стиль вывода названия книг и сделать шторку по нажатию выведятся все страницы. Также выводить кол-во страниц со словами в книге
[x] TODO -> Верстка. Изменить стиль панели для pdf (панель упрвления, канвас блок)
[x] TODO -> Верстка. Сделать невидимым блок с PDF, по нажатию на страницу видимым

[x] TODO -> Ввод слов для поиска с формы
Для поиска используется action="/search" method='get', т.е. необходимо поменять способ ввода слов для поиска.
Можно попробовать связать по событию кнопки метод get. также в зависимости от флага (-qa or -bks) событие в search или books странице.
Можно оставить старым способом просто в странице search менять блок с выводом проверку можно сделать в jinja и app.py.

Сделал пока так: для поиска по книгам нужно ввести в поле поиска флаг -bks. После флага с пробелом идут строка с запросом. В app.py есть проверка если есть этот флаг (символы -bks с пробелом после) то делаю поиск по файлам и вывожу страницу books с данными, если нет то обычный поиск по БД с сайтов.
Что нужно будет сделать на будущее:
- проверка на вводимые символы
- удаление ненужных пробелов
- подумать о безопасности
- сделать всё в одной странице html (а не search и books), динамически генерировать шаблоны по данным

[c] TODO -> Добавить данные с форума (страница, отображение)

[t] TODO -> Вспомнить всё, что делал за эту практику по дням для заполнения дневника и дока
[t] TODO -> Начать писать док

[e] TODO -> Исправить. При переходе на страницу и когда выполняется openFilePdf после идут ежесекундные запросы на файл pdf

[d] TODO -> Верстка. Добавить иконку с анимацией при загрузки pdf, а также при загрузки страниц
[d?] TODO -> Иконки в панели вместо слов


Задачи глобальные
------------------------
Верстка
- Панель управления pdf
- Поменять главную страницу
- Скрывающееся меню на странице "Приложение"
- Адаптивная верстка
-? Изменение верстки всего сайта (изменение шрифта, возможно цветовой темы на темную)
- Изменение верстки вывода вопросов
- Изменение верстки поиска
- По возможности добавить ViewerJS для отображения pdf

Функционал
- Исслеовательская часть
- Сохранение и вывод результатов исследования на графике
- Вывод книг для чтения (отдельная страница books)
- Вывод ответов (лучшего ответа) после поиска
- Парсеры для других выбранных сайтов
- Парсинг этих сайтов
- Добавление на сайт и вывод
- Рефакторинг, оптимизация, тестирование



до 16.04.2018 
Задачи до ПОНЕДЕЛЬНИКА
----------------------

[ ] TODO -> вспомнить что делал и разбить на структуру
[ ] TODO -> начать писать по структуре
[ ] TODO -> начать писать док для практики не менее 10 страниц



ОТЧЕТ ПО ПРОИЗВОДСТВЕННОЙ ПРАКТИКЕ
==================================

Что я сделал на практике?
-------------------------
- Парсер для форума, сам парсинг
    Разбор, какие данные нужно скачать
    Написание парсера, который получает эти данные
    Сохранение в БД
- Работа с PDF. Способ поиска по файлу и отображение на сайте
    Рассмотр способов для поиска в файле
    Поиск модулей или программ для изменения PDF в текстовый файл
    Поиск программ для отображения на сайте
    Изменение pdf в тескт при помощи программы Adobe
    Отбображение на сайте при помощи pdf.js
- Верстка некоторых элементов страницы

Во введении написать тему, цель и задачи (практики), новизна(скорее всего её нет), 
актуальность(того что я делаю в отображении больше данных)

Разбить на 2 главы 
- 1 теория того что я делал, как и что искал что нашёл 
- 2 практика как это реализовал, проблемы, ошибки, что получилось в конце

Заключение что сделал, что буду делать, общие результаты и выводы

Как писать теоретическую часть? 
Как будто она уже реализованна(сразу описать что сделал и что на выходе) 
или ход реализации(как велась работа, что думал сделать, почему не сделал, как сделал окончательно)
Тут есть несостыковка в теории с практикой. Если я начну описывать теорию, я должен буду показать 
почему так сделал, но это уже в практике должно быть.
Нужно в теории написать только изначальные теоретические данные и задумки, а в практике уже весь ход событий
и почему так не сделал как задумывал.

Парсер
------
1. теория
Что из себя представляет сайт
Входные данные и как их достать
2. практика
пошагово как писал парсер
из чего состоит
 - функции, пошаговое описание
 - вводные данные
 - выходные данные
логическая структура
схема работы


Вывод pdf и результатов
-----------------------
Создание страницы
Изменение вывода страницы и работы с формой поиска
Вывод результатов поиска отдельного скрипта
Вывод книги и связка с результатами

Что ещё нужно
-------------
Проблемные ситуации с PDF.js 
Заключение Выводы по проделанной работе
что сделал, что надо доделать
список литературы 
приложение, оформление

Ошибки и проблемы
-----------------
Поиск
------
не все книги добавились описать какие добавил и какие не переформатировались

PDF
---
пустые страницы
getDocument переходы по страницам
изменение цикла с количеством страниц
выделение найденных слов


